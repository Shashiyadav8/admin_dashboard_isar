{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import'./Bills.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_BASE=process.env.REACT_APP_API_BASE_URL;const Bills=()=>{const[productId,setProductId]=useState('');const[file,setFile]=useState(null);const[bills,setBills]=useState([]);const[inventoryItems,setInventoryItems]=useState([]);const[editingBillId,setEditingBillId]=useState(null);useEffect(()=>{fetchBills();fetchInventory();},[]);const fetchBills=async()=>{try{const res=await axios.get(`${API_BASE}/bills`);setBills(res.data);}catch(err){console.error(err);}};const fetchInventory=async()=>{try{const res=await axios.get(`${API_BASE}/inventory`);setInventoryItems(res.data);}catch(err){console.error(err);}};const handleSearch=()=>{const found=inventoryItems.find(item=>item.product_id===productId);if(found){alert(`Product ID \"${productId}\" is valid.`);}else{alert(`Product ID \"${productId}\" is INVALID.`);}};const handleFileChange=e=>{setFile(e.target.files[0]);};const handleUpload=async e=>{e.preventDefault();if(!file){alert('Please select a PDF file.');return;}try{const formData=new FormData();formData.append('product_id',productId);formData.append('bill',file);if(editingBillId){await axios.put(`${API_BASE}/bills/${editingBillId}`,formData,{headers:{'Content-Type':'multipart/form-data'}});alert('Bill updated successfully!');setEditingBillId(null);}else{await axios.post(`${API_BASE}/bills/upload`,formData,{headers:{'Content-Type':'multipart/form-data'}});alert('Bill uploaded successfully!');}setFile(null);fetchBills();}catch(err){console.error(err);alert('Error uploading bill.');}};const handleDelete=async id=>{if(window.confirm('Are you sure you want to delete this bill?')){try{await axios.delete(`${API_BASE}/bills/${id}`);fetchBills();}catch(err){console.error(err);alert('Error deleting bill.');}}};const handleEdit=bill=>{setProductId(bill.product_id);setEditingBillId(bill._id);alert('Select a new PDF to replace the existing one.');};return/*#__PURE__*/_jsxs(\"div\",{className:\"bills\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Bills\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-section\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Search Product ID:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:productId,onChange:e=>setProductId(e.target.value),placeholder:\"Enter Product ID\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSearch,children:\"Search\"})]}),/*#__PURE__*/_jsxs(\"form\",{className:\"upload-section\",onSubmit:handleUpload,children:[/*#__PURE__*/_jsx(\"label\",{children:editingBillId?'Update PDF:':'Upload Bill PDF:'}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"application/pdf\",onChange:handleFileChange}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:editingBillId?'Update PDF':'Upload'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bill-list\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Uploaded Bills\"}),bills.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No bills uploaded yet.\"}):/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Product ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"PDF Link\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Uploaded At\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:bills.map(bill=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{\"data-label\":\"Product ID\",children:bill.product_id}),/*#__PURE__*/_jsx(\"td\",{\"data-label\":\"PDF Link\",children:/*#__PURE__*/_jsx(\"a\",{href:`${process.env.REACT_APP_API_BASE_URL.replace('/api','')}${bill.fileUrl}`,target:\"_blank\",rel:\"noreferrer\",children:\"View PDF\"})}),/*#__PURE__*/_jsx(\"td\",{\"data-label\":\"Uploaded At\",children:new Date(bill.uploadedAt).toLocaleString()}),/*#__PURE__*/_jsxs(\"td\",{\"data-label\":\"Actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"edit-btn\",onClick:()=>handleEdit(bill),children:\"Update\"}),/*#__PURE__*/_jsx(\"button\",{className:\"delete-btn\",onClick:()=>handleDelete(bill._id),children:\"Delete\"})]})]},bill._id))})]})]})]});};export default Bills;","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","API_BASE","process","env","REACT_APP_API_BASE_URL","Bills","productId","setProductId","file","setFile","bills","setBills","inventoryItems","setInventoryItems","editingBillId","setEditingBillId","fetchBills","fetchInventory","res","get","data","err","console","error","handleSearch","found","find","item","product_id","alert","handleFileChange","e","target","files","handleUpload","preventDefault","formData","FormData","append","put","headers","post","handleDelete","id","window","confirm","delete","handleEdit","bill","_id","className","children","type","value","onChange","placeholder","onClick","onSubmit","accept","length","map","href","replace","fileUrl","rel","Date","uploadedAt","toLocaleString"],"sources":["/mnt/data/accounts/my-frontend/src/pages/Bills.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport './Bills.css';\r\n\r\nconst API_BASE = process.env.REACT_APP_API_BASE_URL;\r\n\r\nconst Bills = () => {\r\n  const [productId, setProductId] = useState('');\r\n  const [file, setFile] = useState(null);\r\n  const [bills, setBills] = useState([]);\r\n  const [inventoryItems, setInventoryItems] = useState([]);\r\n  const [editingBillId, setEditingBillId] = useState(null);\r\n\r\n  useEffect(() => {\r\n    fetchBills();\r\n    fetchInventory();\r\n  }, []);\r\n\r\n  const fetchBills = async () => {\r\n    try {\r\n      const res = await axios.get(`${API_BASE}/bills`);\r\n      setBills(res.data);\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  const fetchInventory = async () => {\r\n    try {\r\n      const res = await axios.get(`${API_BASE}/inventory`);\r\n      setInventoryItems(res.data);\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  const handleSearch = () => {\r\n    const found = inventoryItems.find(item => item.product_id === productId);\r\n    if (found) {\r\n      alert(`Product ID \"${productId}\" is valid.`);\r\n    } else {\r\n      alert(`Product ID \"${productId}\" is INVALID.`);\r\n    }\r\n  };\r\n\r\n  const handleFileChange = (e) => {\r\n    setFile(e.target.files[0]);\r\n  };\r\n\r\n  const handleUpload = async (e) => {\r\n    e.preventDefault();\r\n    if (!file) {\r\n      alert('Please select a PDF file.');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('product_id', productId);\r\n      formData.append('bill', file);\r\n\r\n      if (editingBillId) {\r\n        await axios.put(`${API_BASE}/bills/${editingBillId}`, formData, {\r\n          headers: { 'Content-Type': 'multipart/form-data' },\r\n        });\r\n        alert('Bill updated successfully!');\r\n        setEditingBillId(null);\r\n      } else {\r\n        await axios.post(`${API_BASE}/bills/upload`, formData, {\r\n          headers: { 'Content-Type': 'multipart/form-data' },\r\n        });\r\n        alert('Bill uploaded successfully!');\r\n      }\r\n\r\n      setFile(null);\r\n      fetchBills();\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert('Error uploading bill.');\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    if (window.confirm('Are you sure you want to delete this bill?')) {\r\n      try {\r\n        await axios.delete(`${API_BASE}/bills/${id}`);\r\n        fetchBills();\r\n      } catch (err) {\r\n        console.error(err);\r\n        alert('Error deleting bill.');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleEdit = (bill) => {\r\n    setProductId(bill.product_id);\r\n    setEditingBillId(bill._id);\r\n    alert('Select a new PDF to replace the existing one.');\r\n  };\r\n\r\n  return (\r\n    <div className=\"bills\">\r\n      <h1>Bills</h1>\r\n\r\n      <div className=\"search-section\">\r\n        <label>Search Product ID:</label>\r\n        <input\r\n          type=\"text\"\r\n          value={productId}\r\n          onChange={(e) => setProductId(e.target.value)}\r\n          placeholder=\"Enter Product ID\"\r\n        />\r\n        <button onClick={handleSearch}>Search</button>\r\n      </div>\r\n\r\n      <form className=\"upload-section\" onSubmit={handleUpload}>\r\n        <label>{editingBillId ? 'Update PDF:' : 'Upload Bill PDF:'}</label>\r\n        <input type=\"file\" accept=\"application/pdf\" onChange={handleFileChange} />\r\n        <button type=\"submit\">{editingBillId ? 'Update PDF' : 'Upload'}</button>\r\n      </form>\r\n\r\n      <div className=\"bill-list\">\r\n        <h2>Uploaded Bills</h2>\r\n        {bills.length === 0 ? (\r\n          <p>No bills uploaded yet.</p>\r\n        ) : (\r\n          <table>\r\n            <thead>\r\n              <tr>\r\n                <th>Product ID</th>\r\n                <th>PDF Link</th>\r\n                <th>Uploaded At</th>\r\n                <th>Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {bills.map((bill) => (\r\n                <tr key={bill._id}>\r\n                  <td data-label=\"Product ID\">{bill.product_id}</td>\r\n                  <td data-label=\"PDF Link\">\r\n                    <a\r\n                      href={`${process.env.REACT_APP_API_BASE_URL.replace('/api', '')}${bill.fileUrl}`}\r\n                      target=\"_blank\"\r\n                      rel=\"noreferrer\"\r\n                    >\r\n                      View PDF\r\n                    </a>\r\n                  </td>\r\n                  <td data-label=\"Uploaded At\">{new Date(bill.uploadedAt).toLocaleString()}</td>\r\n                  <td data-label=\"Actions\">\r\n                    <button className=\"edit-btn\" onClick={() => handleEdit(bill)}>Update</button>\r\n                    <button className=\"delete-btn\" onClick={() => handleDelete(bill._id)}>Delete</button>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Bills;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}